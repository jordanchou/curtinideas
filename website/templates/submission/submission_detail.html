{% extends 'base.html' %}

{% block content %}
	<div class="submission">
			{% if post.published_date %}
					<div class="date">
							{{ submission.published_date }}
					</div>
			{% endif %}
			<h1>{{ submission.title }}</h1>
			<h2>{{submission.author.get_full_name }}</h2>
			<h2>{{submission.category}}</h2>
			<p>{{ submission.text|linebreaks }}</p>
			<h4>Links</h4>
			<a target="_blank" href="{{ submission.links }}">{{ submission.links }}</a>

	</div>
	{% if user.is_authenticated %}
	<a class="btn btn-default" href="{% url 'submission:comment_on_submission' slug=user.slug pk=submission.pk %}">Comment/Improvement</a>
	{% endif %}

	<hr>
	<ul class="nav nav-tabs">
		<li class="active"><a href="#comments" data-toggle="tab">Comments</a></li>
		<li class=""><a data-toggle="tab" href="#improvements">Improvements</a></li>
	</ul>

	<div id="my_tab_content" class="tab-content">
		<div id="comments" class="tab-pane fade in active">
			<h3>Comments</h3>
			{% for comment in submission.comments.all %}
			{% if not comment.is_improvement %}
			<div class="table-responsive">
				<table class="table table-striped table-hover ">
					<tbody>
						<tr>
							<td>
								<div class="comment">
									<div class="date">{{ comment.created_date }}</div>
									<strong>{{comment.author}}</strong>
									<p>{{ comment.text|linebreaks }}</p>
								</div>
							</td>
							{% if user.email = comment.author.get_email %}
								<td style="vertical-align:middle; text-align:right;">
									<a href="{% url 'submission:comment_edit' pk=comment.pk %}" class="btn btn-warning">Edit</a>
								</td>
								<td style="vertical-align:middle; text-align:right;">
									<a href="{% url 'submission:comment_delete' pk=comment.pk %}" class="btn btn-danger">Delete</a>
								</td>
							{% else %}
								<td></td>
							{% endif %}
						</tr>
					</tbody>
				</table>
			</div>
			{% endif %}
			{% empty %}
				<p>No Comments</p>
			{% endfor %}
		</div>


		<div id="improvements" class="tab-pane fade">
			<h3>Improvements</h3>
			{% for comment in submission.comments.all %}
			{% if comment.is_improvement %}
			<div class="table-responsive">
				<table class="table table-striped table-hover ">
					<tbody>
						<tr>
							<td>
								<div class="comment">
									<div class="date">{{ comment.created_date }}</div>
									<strong>{{comment.author}}</strong>
									<p>{{ comment.text|linebreaks }}</p>
								</div>
							</td>
							{% if user.email = comment.author.get_email %}
								<td style="vertical-align:middle; text-align:right;">
									<a href="{% url 'submission:comment_edit' pk=comment.pk %}" class="btn btn-warning">Edit</a>
								</td>
								<td style="vertical-align:middle; text-align:right;">
									<a href="{% url 'submission:comment_delete' pk=comment.pk %}" class="btn btn-danger">Delete</a>
								</td>
							{% else %}
								<td></td>
							{% endif %}
						</tr>
					</tbody>
				</table>
			</div>
			{% endif %}
			{% empty %}
				<p>No Improvements</p>
			{% endfor %}		
		</div>
	</div>
	

{% endblock %}
